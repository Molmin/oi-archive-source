
# Description

<div class="content"><div>
<div>小C最近在学习线性函数，线性函数可以表示为：f(x) = kx + b。</div>
<div>现在小C面前有n个线性函数fi(x)=kix+bi ，他对这n个线性函数执行m次操作，</div>
<div>每次可以：</div>
<div>1.M i K B 代表把第i个线性函数改为：fi(x)=kx+b 。</div>
<div>2.Q l r x 返回fr(fr-1(...fl(x)))  mod  10^9+7 。</div>
</div>
<p></p></div>

# Input

<div class="content"><div>
<div>第一行两个整数n, m </div>
<div>接下来n行，每行两个整数ki, bi。</div>
<div>接下来m行，每行的格式为M i K B或者Q l r x。</div>
<div>1 &lt;= n, m &lt;= 200,000，0 &lt;= k, b, x &lt; 1000,000,007</div>
</div>
<p></p></div>

# Output

<div class="content"><div>对于每个Q操作，输出一行答案。</div>
<div></div>
<p></p></div>

# Sample Input

<div class="content"><span class="sampledata">5 5<br/>
4 2<br/>
3 6<br/>
5 7<br/>
2 6<br/>
7 5<br/>
Q 1 5 1<br/>
Q 3 3 2<br/>
M 3 10 6<br/>
Q 1 4 3<br/>
Q 3 4 4</span></div>

# Sample Output

<div class="content"><span class="sampledata">1825<br/>
17<br/>
978<br/>
98</span></div>

# Hint

<div class="content"><p></p><p></p><br/>
<p></p><p></p></div>

# Source

<div class="content"><p><a href="problemset.php?search="></a></p></div>

